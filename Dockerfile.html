

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>AtacWorks Dockerfile &mdash; atacworks v0.3.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Denoising and peak calling using a trained AtacWorks model" href="tutorials/tutorial2.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> atacworks
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">AtacWorks</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/pretrained_models.html">Pretrained_models</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/tutorial1.html">Training an AtacWorks model</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/tutorial2.html">Denoising and peak calling using a trained AtacWorks model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">AtacWorks Dockerfile</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#install-docker-with-gpu-support">Install Docker with GPU support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pre-installed-atacworks">Pre-installed AtacWorks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#atacworks-from-source">AtacWorks from Source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#run-custom-workflow-in-docker">Run custom workflow in docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-docker-in-interactive-mode-with-port-forwarding-for-jupyter-notebooks">Run Docker in interactive mode with port forwarding for Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#faq">FAQ</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">atacworks</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>AtacWorks Dockerfile</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Dockerfile.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="atacworks-dockerfile">
<h1>AtacWorks Dockerfile<a class="headerlink" href="#atacworks-dockerfile" title="Permalink to this headline">¶</a></h1>
<p>All the AtacWorks SDK components can be executed inside a docker environment. For ease of use,
the AtacWorks team has created a public docker image that can be pulled to run the toolkit.</p>
<div class="section" id="install-docker-with-gpu-support">
<h2>Install Docker with GPU support<a class="headerlink" href="#install-docker-with-gpu-support" title="Permalink to this headline">¶</a></h2>
<p>Docker now ships with native support for GPU. Please follow the instructions on the <a class="reference external" href="https://github.com/nvidia/nvidia-docker/wiki/Installation-(Native-GPU-Support)">nvidia-docker</a>
page to setup the docker framework correctly.
Verify that the setup above completed successfully and your system has access to <a class="reference external" href="https://hub.docker.com/r/claraomics/atacworks">Docker Hub</a>.</p>
<p>We provide two different images to run AtacWorks from:
* claraomics/atacworks:latest - This image contains pre-installed atacworks toolkit. It can be used for
running training, denoising and evaluating workflows without the need of cloning the repository. Look at the section
“Pre-installed AtacWorks” below for instructions to pull that image.
* claraomics/atacworks:source-latest - This image clones atacworks repository and installs atacworks from the
source. This image is useful for getting familiar with the source code, to run atacworks tutorial notebooks etc. Look at the
section “AtacWorks from Source” below for instructions to pull that image.</p>
<div class="section" id="pre-installed-atacworks">
<h3>Pre-installed AtacWorks<a class="headerlink" href="#pre-installed-atacworks" title="Permalink to this headline">¶</a></h3>
<p>Run the following command to launch a docker container that contains pre-installed latest version of AtacWorks in interactive mode.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">--</span><span class="n">gpus</span> <span class="nb">all</span> <span class="o">--</span><span class="n">shm</span><span class="o">-</span><span class="n">size</span> <span class="mi">2</span><span class="n">G</span> <span class="n">claraomics</span><span class="o">/</span><span class="n">atacworks</span><span class="p">:</span><span class="n">latest</span>
</pre></div>
</div>
<p>If the above command doesn’t run successfully, please stop and re-install docker or contact the
AtacWorks dev team on GitHub for more help.</p>
</div>
<div class="section" id="atacworks-from-source">
<h3>AtacWorks from Source<a class="headerlink" href="#atacworks-from-source" title="Permalink to this headline">¶</a></h3>
<p>To pull the docker image that clones and installs atacworks from source, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">--</span><span class="n">gpus</span> <span class="nb">all</span> <span class="o">--</span><span class="n">shm</span><span class="o">-</span><span class="n">size</span> <span class="mi">2</span><span class="n">G</span> <span class="n">claraomics</span><span class="o">/</span><span class="n">atacworks</span><span class="p">:</span><span class="n">source</span><span class="o">-</span><span class="n">latest</span>
</pre></div>
</div>
<p>If the above command doesn’t run successfully, please stop and re-install docker or contact the
AtacWorks dev team on GitHub for more help.</p>
</div>
</div>
<div class="section" id="run-custom-workflow-in-docker">
<h2>Run custom workflow in docker<a class="headerlink" href="#run-custom-workflow-in-docker" title="Permalink to this headline">¶</a></h2>
<p>Before starting on custom workflows please refer to the tutorials available in the README of the repository. Those will
help you get familiarized with the features of the SDK.
Once you are comfortable with them, you can use the docker environment to run all of the commands with ease.</p>
<p>Remember to use the tag “latest” or “source-latest” depending on whether you need AtacWorks source code or not. By default,
<code class="docutils literal notranslate"><span class="pre">claraomics/atacworks</span></code> will pull the “latest” tag.</p>
<ul class="simple">
<li><p>Mount volumes to the container
Use the <code class="docutils literal notranslate"><span class="pre">-v</span></code> option in docker to mount volumes with your data. Official documentation for the options can be found <a class="reference external" href="https://docs.docker.com/storage/volumes/">here</a>.</p></li>
<li><p>Use mounted dataset with containerized toolkit, example shown below</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">gpus</span> <span class="nb">all</span> <span class="o">--</span><span class="n">shm</span><span class="o">-</span><span class="n">size</span> <span class="mi">2</span><span class="n">G</span> <span class="o">-</span><span class="n">v</span> <span class="o">/</span><span class="n">ssd</span><span class="o">/</span><span class="n">my_atacworks_data</span><span class="p">:</span><span class="o">/</span><span class="n">data</span> <span class="n">claraomics</span><span class="o">/</span><span class="n">atacworks</span> \
        <span class="n">atacworks</span> <span class="n">denoise</span> \
        <span class="o">--</span><span class="n">noisybw</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">noisy</span><span class="o">.</span><span class="n">bw</span> \
        <span class="o">--</span><span class="n">genome</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">hg19</span><span class="o">.</span><span class="n">auto</span><span class="o">.</span><span class="n">sizes</span> \
        <span class="o">--</span><span class="n">out_home</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">output</span> \
        <span class="o">--</span><span class="n">distributed</span>
</pre></div>
</div>
</div>
<div class="section" id="run-docker-in-interactive-mode-with-port-forwarding-for-jupyter-notebooks">
<h2>Run Docker in interactive mode with port forwarding for Jupyter notebooks<a class="headerlink" href="#run-docker-in-interactive-mode-with-port-forwarding-for-jupyter-notebooks" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">--</span><span class="n">gpus</span> <span class="nb">all</span> <span class="o">--</span><span class="n">shm</span><span class="o">-</span><span class="n">size</span> <span class="mi">2</span><span class="n">G</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8888</span><span class="p">:</span><span class="mi">8888</span> <span class="n">claraomics</span><span class="o">/</span><span class="n">atacworks</span><span class="p">:</span><span class="n">source</span><span class="o">-</span><span class="n">latest</span>
</pre></div>
</div>
<p>Note: Jupyter notebook will have to be started manually once inside the container. Below is an example command to launch the jupyter-lab.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyter</span><span class="o">-</span><span class="n">lab</span> <span class="o">--</span><span class="n">ip</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span> <span class="o">--</span><span class="n">allow</span><span class="o">-</span><span class="n">root</span>
</pre></div>
</div>
<p>The above command will print out a URl that you can open in your browser.</p>
</div>
<div class="section" id="faq">
<h2>FAQ<a class="headerlink" href="#faq" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Unexpected bus error, how to troubleshoot?</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">ERROR</span><span class="p">:</span> <span class="n">Unexpected</span> <span class="n">bus</span> <span class="n">error</span> <span class="n">encountered</span> <span class="ow">in</span> <span class="n">worker</span><span class="o">.</span> <span class="n">This</span> <span class="n">might</span> <span class="n">be</span> <span class="n">caused</span> <span class="n">by</span> <span class="n">insufficient</span> <span class="n">shared</span> <span class="n">memory</span> <span class="p">(</span><span class="n">shm</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
<p>A. This happens when docker container does not have enough shared memory allocation for deep learning frameworks. Checkout this doc on shared memory allocation <a class="reference external" href="https://docs.nvidia.com/deeplearning/frameworks/user-guide/index.html#setincshmem">here</a>. You can run your docker by adding this flag <code class="docutils literal notranslate"><span class="pre">--shm-size</span></code>. Increase the memory to 1GB or higher.</p>
<ol class="simple">
<li><p>How can I build my own custom Dockerfile ?
A. AtacWorks repository contains a <a class="reference external" href="https://github.com/clara-parabricks/AtacWorks/blob/master/Dockerfile">Dockerfile</a> to allow users to build a custom docker image. To build your own docker image, enter the root directory of AtacWorks repository.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">atacworks</span><span class="o">-</span><span class="n">root</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Make and save changes if any to the Dockerfile. The run the following command to build a docker image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">build</span> <span class="o">.</span> <span class="o">-</span><span class="n">t</span> <span class="n">atacworks</span><span class="p">:</span><span class="n">custom</span>
</pre></div>
</div>
<p>You can launch a docker container with this image using the commands in the sections above. Just replace the image “claraomics/atacworks” with “atacworks:custom” or any other name you choose to give.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="tutorials/tutorial2.html" class="btn btn-neutral float-left" title="Denoising and peak calling using a trained AtacWorks model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, NVIDIA Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>